function dateFormat(n){var t=("0"+n.getDate()).slice(-2),i=("0"+(n.getMonth()+1)).slice(-2);return n.getFullYear()+"-"+i+"-"+t}function getSelectedImages(n){for(var i=n.get(0).files,r=new FormData,t=0;t<i.length;t++)r.append(i[t].name,i[t]);return r}function CreateUpdateCustomer(){this.Id="";this.FirstName="";this.LastName="";this.DateOfBirth="";this.Cnic="";this.PhoneNumber="";this.ImagePath="";this.IsActive="";this.CreatedBy="";this.CreatedDate="";this.UpdatedBy="";this.UpdatedDate="";this.UserId="";this.Email="";this.Password="";this.RoleId=""}$(function(){jQuery.validator.addMethod("letteronly",function(n,t){return this.optional(t)||/^[A-Za-z ]+$/i.test(n)},"Enter only alphabetical characters");jQuery.validator.addMethod("numberonly",function(n,t){return this.optional(t)||/^[0-9]+$/i.test(n)},"Number Only");jQuery.validator.addMethod("numberonlyCnic",function(n,t){return this.optional(t)||/^[0-9-]+$/i.test(n)},"Number Only");jQuery.validator.addMethod("letternumberonly",function(n,t){return this.optional(t)||/^[a-zA-Z0-9 ]+$/i.test(n)},"Number and Alphabets Only");jQuery.validator.addMethod("emailRegex",function(n,t){return this.optional(t)||/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/i.test(n)},"Please Provide Correct Email");jQuery.validator.addMethod("passwordRegex",function(n,t){return this.optional(t)||/([^a-zA-Z\d])+([a-zA-Z\d])+|([a-zA-Z\d])+([^a-zA-Z\d])+/i.test(n)},"Password Must Contain AlphaNumeric With Special Character Like Etc_121");jQuery.validator.addMethod("StartDateFromCurrentDate",function(n,t){var i=new Date,r=new Date(Date.parse(n));return this.optional(t)||r>i||i.getMonth()+1==r.getMonth()+1&&i.getDate()==r.getDate()&&i.getFullYear()==r.getFullYear()},"Start Date Not Be Previous Date");jQuery.validator.addMethod("EndDateFromTodayDate",function(n,t){return this.optional(t)||new Date(Date.parse(n))>new Date},"End Date Lesser Then Today");jQuery.validator.addMethod("greaterThan",function(n,t,i){var r=$(i).val();return/Invalid|NaN/.test(new Date(n))?isNaN(n)&&isNaN(r)||Number(n)>Number(r):new Date(n)>new Date(r)},"Must be greater than StartDate.")});$(function(){if($("#EditCutomerId").val()>0){var n=$("#EditCutomerId").val();n!=""&&n!=null&&$.ajax({url:"/ClientListing/GetCustomerById",type:"get",datatype:"json",data:{Id:n},"async":!1,headers:{RequestVerificationToken:$('input:hidden[name="__RequestVerificationToken"]').val()},success:function(n){n!=null?($("#UCustId").val(n.id),n.imagePath!=null&&n.imagePath!=""?$("#UtargetImg").attr("src",n.imagePath):$("#UtargetImg").attr("src","/PakDial-assets/images/user-d.png"),n.isActive==!0&&$("#UCIsActive").prop("checked",!0),$("#UUserId").val(n.userId),$("#UCustFirstName").val(n.firstName),$("#UCustLastName").val(n.lastName),$("#UCustDob").val(dateFormat(new Date(Date.parse(n.dateOfBirth)))),$("#UCustCnic").val(n.cnic),$("#UCustContactNumber").val(n.phoneNumber),$("#UCustPhoneNumber").val(n.phoneNumber)):toastr.error("Customer Not Exits","Error")},error:function(n){toastr.error(n,"Error")}})}});$("#UpdateCustomer_Submit_Form").validate({rules:{UCustId:{required:!0},UUserId:{required:!0},UCustFirstName:{required:!0,letteronly:!0},UCustLastName:{required:!0,letteronly:!0},UCustDob:{required:!0},UCustCnic:{required:!0,numberonlyCnic:!0},UCustContactNumber:{required:!0,numberonly:!0},UCustPhoneNumber:{numberonly:!0}},messages:{UCustId:{required:"Please provide a valid Employee Passcode."},UUserId:{required:"Please provide a valid Employee Passcode."},UCustFirstName:{required:"Please Enter First Name."},UCustLastName:{required:"Please Enter Last Name."},UCustDob:{required:"Please Enter Date of Birth."},UCustCnic:{required:"Please Enter CNIC."},UCustContactNumber:{required:"Please Enter Contact Number."}},highlight:function(n){$(n).closest(".form-group").addClass("text-danger")},unhighlight:function(n){$(n).closest(".form-group").removeClass("text-danger")},wrapper:"div",errorClass:"text-danger",errorPlacement:function(n,t){n.insertAfter(t)},submitHandler:function(){$("#UpdateCustShowLoader").show();$("#UpdateCustShowButtons").hide();var n=new CreateUpdateCustomer;n.Id=$("#UCustId").val();n.UserId=$("#UUserId").val();n.FirstName=$("#UCustFirstName").val();n.LastName=$("#UCustLastName").val();n.DateOfBirth=$("#UCustDob").val();n.Cnic=$("#UCustCnic").val();n.ContactNo=$("#UCustContactNumber").val();n.PhoneNumber=$("#UCustContactNumber").val();$.ajax({url:"/ClientListing/UpdateCustomer",type:"post",datatype:"json",data:{customer:n},"async":!1,headers:{RequestVerificationToken:$('input:hidden[name="__RequestVerificationToken"]').val()},success:function(n){if(n.error=="403")location.href="/Account/AccessDenied";else if(n==1){var t=$("#Uimagefiles").get(0).files,i=new FormData,r=$("#UCustId").val();i.append("file",t[0]);t.length>0?$.ajax({url:"/ClientListing/UploadProfileImage?Id="+r,type:"post",datatype:"json",data:i,"async":!1,cache:!1,contentType:!1,processData:!1,success:function(n){n==1?($("#UpdateCustomer").modal("hide"),$("#UpdateCustShowLoader").hide(),$("#UpdateCustShowButtons").show(),toastr.success("Customer Updated Successfully","Success"),window.location.href="/profileUser/Profile"):n.error=="403"?location.href="/Account/AccessDenied":($("#UpdateCustShowLoader").hide(),$("#UpdateCustShowButtons").show(),toastr.error("Failed to Upload Image","Error"))},error:function(n){$("#UpdateCustShowLoader").hide();$("#UpdateCustShowButtons").show();toastr.error(n,"Error")}}):($("#UpdateCustomer").modal("hide"),$("#UpdateCustShowLoader").hide(),$("#UpdateCustShowButtons").show(),toastr.success("Customer Updated Successfully","Success"),window.location.href="/profileUser/Profile")}else n==2?($("#UpdateCustShowLoader").hide(),$("#UpdateCustShowButtons").show(),toastr.error("Cnic Already Exits","Error")):($("#UpdateCustShowLoader").hide(),$("#UpdateCustShowButtons").show(),toastr.error("Customer Not Saved","Error"))},error:function(n){$("#UpdateCustShowLoader").hide();$("#UpdateCustShowButtons").show();toastr.error(n,"Error")}})}});$("#btnClose").click(function(){window.location.href="/profileUser/Profile"});$("#Uimagefiles").change(function(){var n=this.files;n&&n[0]&&UReadImage(n[0])});var UReadImage=function(n){var t=new FileReader,i=new Image;t.readAsDataURL(n);t.onload=function(t){i.src=t.target.result;i.onload=function(){var i=this.height,r=this.width,u=n.type,f=~~(n.size/1024)+"KB";$("#UtargetImg").attr("src",t.target.result)}}};$("#ACustCnic,#UCustCnic").keydown(function(){if(event.keyCode!=8&&event.keyCode!=9&&event.keyCode!=27&&event.keyCode!=13&&(event.keyCode!=65||event.ctrlKey!==!0)){(event.keyCode<48&&event.keyCode>57||event.keyCode<96&&event.keyCode>105)&&event.preventDefault();var n=$(this).val().length;(n==5||n==13)&&$(this).val($(this).val()+"-")}});$("#UCustPhoneNumber").focusout(function(){var n=$(this).val(),t=$("#UCustId").val();n!=""&&$.ajax({url:"/ClientListing/CheckMobileExiting",type:"get",datatype:"json",data:{phone:n,id:t},headers:{RequestVerificationToken:$('input:hidden[name="__RequestVerificationToken"]').val()},success:function(n){n>0&&(toastr.error("Number Already Exits"),$("#UCustPhoneNumber").val(""),$("#UCustPhoneNumber").focus())},error:function(n){toastr.error(n)}})});